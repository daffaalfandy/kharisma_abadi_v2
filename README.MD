# Kharisma Abadi V2

Modern, maintainable rebuild of the Kharisma Abadi multi-service cashier system.

## üè¢ About

Kharisma Abadi is a comprehensive multi-service business offering:
- üöó **Car Wash Service** - Professional vehicle washing
- üëï **Laundry Service** - Clothing and textile cleaning
- üß∫ **Carpet Washing Service** - Professional carpet and upholstery cleaning
- üíß **Drinking Water Delivery Service** - Bottled water distribution

This is a complete rebuild focusing on **maintainability**, **scalability**, and modern development practices.

**Key Improvements:**
- Consolidated schema from legacy 10+ tables to unified design
- Zero data loss migration of 67,000+ production records
- Clean Architecture with clear separation of concerns
- Comprehensive testing (unit, integration, E2E)
- Production-ready security implementation
- Complete API and business logic documentation

## üìö Documentation

**Start Here:**
1. [REFERENCE.md](./REFERENCE.md) - Complete documentation index
2. [docs/planning/PRD.md](./docs/planning/PRD.md) - Product requirements
3. [docs/technical/TECHNICAL-SPEC.md](./docs/technical/TECHNICAL-SPEC.md) - Technical specifications

**Full Documentation Structure:**
- `docs/planning/` - Requirements, user stories, product backlog
- `docs/technical/` - Architecture decisions, API specifications
- `docs/business-logic/` - Business rules and validations
- `docs/business-flows/` - Process flows and state machines
- `docs/database/` - Database schema and migration procedures
- `docs/api/` - Complete API documentation
- `docs/architecture/` - System architecture diagrams

## üõ†Ô∏è Technology Stack

**Backend:**
- Framework: Go 1.21+ with Fiber web framework
- Language: Go (compiled binary)
- Database: MariaDB 11 LTS
- ORM: GORM
- Authentication: JWT with refresh tokens
- Validation: Go validators

**Frontend:**
- Framework: Next.js 14+ (App Router)
- Language: TypeScript 5+
- UI Library: shadcn/ui + Tailwind CSS
- State Management: Zustand + TanStack Query
- Form Handling: React Hook Form + Zod validation

**Infrastructure:**
- Containerization: Docker & Docker Compose
- Database: MariaDB 11
- Web Server: Nginx (reverse proxy)
- Development: Hot reload, debug mode

## üöÄ Quick Start

### Prerequisites

- **Docker Desktop** (includes Docker & Docker Compose)
- **Git** (version 2.30+)
- **Node.js 18+** (for frontend development without Docker)
- **Go 1.21+** (for backend development without Docker)

### Development Setup

1. **Clone the repository:**
   ```bash
   git clone <repository-url>
   cd kharisma-abadi-v2
   ```

2. **Copy environment files:**
   ```bash
   cp backend/.env.example backend/.env
   cp frontend/.env.local.example frontend/.env.local
   ```

3. **Edit environment files:**
   - `backend/.env` - Database credentials and secrets
   - `frontend/.env.local` - API endpoint configuration

4. **Start development environment:**
   ```bash
   # Using Docker Compose (recommended)
   make dev
   
   # Or manually
   docker-compose -f docker-compose.yml -f docker-compose.dev.yml up
   ```

5. **Access the application:**
   - **Frontend:** http://localhost:3000
   - **Backend API:** http://localhost:8000
   - **API Documentation:** http://localhost:8000/docs
   - **Database:** localhost:3306 (MySQL client)

### Available Commands

```bash
# Development & Building
make dev              # Start complete development environment
make build            # Build all services (Docker images)
make clean            # Clean build artifacts and cache

# Testing
make test             # Run all tests (backend + frontend)
make test-backend     # Run backend unit tests
make test-frontend    # Run frontend unit tests
make test-e2e         # Run E2E tests

# Code Quality
make lint             # Run linters on all code
make format           # Auto-format code (Black, Prettier)
make type-check       # Run type checkers (mypy, TypeScript)

# Database
make migrate          # Run pending database migrations
make migrate-create   # Create new migration (prompts for message)
make db-seed          # Seed database with sample data
make db-backup        # Create database backup

# Utilities
make install          # Install all dependencies
make setup            # Initial setup (copy .env files)
make help             # Show all available commands
```

See [Makefile](./Makefile) for all available commands and details.

## üìÅ Project Structure

```
kharisma-abadi-v2/
‚îú‚îÄ‚îÄ backend/                      # Go + Fiber API
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/            # HTTP request handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/            # Business logic layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/        # Data access layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/              # Domain entities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/          # HTTP middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations/          # Database migrations
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.go              # Application entry point
‚îÇ   ‚îú‚îÄ‚îÄ tests/                   # Backend tests
‚îÇ   ‚îú‚îÄ‚îÄ go.mod & go.sum          # Dependency management
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile               # Backend container
‚îÇ   ‚îú‚îÄ‚îÄ .env.example             # Environment template
‚îÇ   ‚îî‚îÄ‚îÄ README.md                # Backend documentation
‚îÇ
‚îú‚îÄ‚îÄ frontend/                     # Next.js + TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/                 # Next.js App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/          # React components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/            # API client services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/               # Custom React hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stores/              # Zustand state
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/               # TypeScript types
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/               # Utility functions
‚îÇ   ‚îú‚îÄ‚îÄ public/                  # Static assets
‚îÇ   ‚îú‚îÄ‚îÄ __tests__/               # Frontend tests
‚îÇ   ‚îú‚îÄ‚îÄ package.json             # Dependencies
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json            # TypeScript config
‚îÇ   ‚îú‚îÄ‚îÄ next.config.js           # Next.js config
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile               # Frontend container
‚îÇ   ‚îú‚îÄ‚îÄ .env.local.example       # Environment template
‚îÇ   ‚îî‚îÄ‚îÄ README.md                # Frontend documentation
‚îÇ
‚îú‚îÄ‚îÄ docs/                        # Complete documentation
‚îÇ   ‚îú‚îÄ‚îÄ planning/                # Requirements & backlog
‚îÇ   ‚îú‚îÄ‚îÄ technical/               # Technical specs
‚îÇ   ‚îú‚îÄ‚îÄ business-logic/          # Business rules
‚îÇ   ‚îú‚îÄ‚îÄ business-flows/          # Process flows
‚îÇ   ‚îú‚îÄ‚îÄ database/                # Schema & migrations
‚îÇ   ‚îú‚îÄ‚îÄ api/                     # API documentation
‚îÇ   ‚îú‚îÄ‚îÄ architecture/            # System diagrams
‚îÇ   ‚îî‚îÄ‚îÄ analysis/                # Legacy analysis
‚îÇ
‚îú‚îÄ‚îÄ scripts/                     # Utility scripts
‚îÇ   ‚îú‚îÄ‚îÄ setup-dev.sh             # Development setup
‚îÇ   ‚îú‚îÄ‚îÄ backup-db.sh             # Database backup
‚îÇ   ‚îú‚îÄ‚îÄ migrate-data.sh          # Data migration
‚îÇ   ‚îî‚îÄ‚îÄ deploy.sh                # Manual deployment
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml           # Development environment
‚îú‚îÄ‚îÄ docker-compose.dev.yml       # Development overrides
‚îú‚îÄ‚îÄ docker-compose.prod.yml      # Production configuration
‚îú‚îÄ‚îÄ Makefile                     # Development commands
‚îú‚îÄ‚îÄ .gitignore                   # Git ignore patterns
‚îú‚îÄ‚îÄ .editorconfig                # Editor configuration
‚îú‚îÄ‚îÄ README.md                    # This file
‚îú‚îÄ‚îÄ CONTRIBUTING.md              # Contribution guidelines
‚îú‚îÄ‚îÄ REFERENCE.md                 # Documentation reference
‚îî‚îÄ‚îÄ LICENSE                      # License (MIT)
```

## üß™ Testing

### Backend Tests

```bash
cd backend
go test -v ./...                 # Run all tests with verbose output
go test -cover ./...            # Run tests with coverage
go test -race ./...             # Run tests with race detector
```

### Frontend Tests

```bash
cd frontend
npm test                         # Run unit tests in watch mode
npm run test:coverage           # Run tests with coverage report
npm run test:e2e                # Run Playwright E2E tests
```

### Test Coverage

Maintain >80% test coverage for critical paths:
- **Backend:** Business logic, API handlers, repositories
- **Frontend:** Components, hooks, utilities

## üîê Security

The application implements comprehensive security measures:

- **Authentication:** JWT tokens with refresh token rotation
- **Authorization:** Role-based access control (RBAC)
  - Admin: Full system access
  - Manager: Orders, customers, reports
  - Cashier: Orders, customer info, payments
- **Data Protection:**
  - Passwords: Bcrypt hashing (cost 12)
  - Sensitive fields: AES-256 encryption
  - Backups: Encrypted storage
- **API Security:**
  - Input validation (Zod + Go validators)
  - SQL injection prevention (ORM parameterized queries)
  - XSS protection (output sanitization)
  - CSRF protection
- **Transport Security:**
  - HTTPS/TLS 1.3 in production
  - Secure HTTP headers
- **Audit Trail:**
  - All changes logged in audit_logs table
  - 7-year retention for compliance

See [docs/architecture/security-architecture.md](./docs/architecture/security-architecture.md) for details.

## üìù Development Workflow

### Feature Development

1. **Pick a task** from `docs/planning/product-backlog.md`
2. **Create feature branch:**
   ```bash
   git checkout -b feature/US-XXX-short-description
   ```
3. **Implement feature** following Clean Architecture patterns
4. **Write tests:** Unit + integration tests (>80% coverage)
5. **Code quality:**
   ```bash
   make lint      # Check for style issues
   make format    # Auto-format code
   ```
6. **Commit with conventional messages:**
   ```
   feat: Add car wash order creation (US-004)
   fix: Correct pricing calculation
   docs: Update API documentation
   test: Add payment service tests
   ```
7. **Create pull request** with test coverage
8. **Code review** and merge

### Deployment (Manual on Windows Client PC)

Manual deployment process for production:

1. **Build backend:**
   ```bash
   cd backend
   go build -o kharisma-api
   ```

2. **Build frontend:**
   ```bash
   cd frontend
   npm run build
   npm start  # Start Next.js server
   ```

3. **Database migration:**
   ```bash
   # Create backup first
   mysqldump -u root -p kharisma_db > backup.sql
   
   # Run migrations
   cd backend
   go run migrations/main.go
   ```

4. **Start application:**
   - Backend: `./kharisma-api`
   - Frontend: `npm start` (or use PM2/NSSM for Windows services)

See [docs/database/IMPLEMENTATION-GUIDE.md](./docs/database/IMPLEMENTATION-GUIDE.md) for detailed migration steps.

## ü§ù Contributing

Please read [CONTRIBUTING.md](./CONTRIBUTING.md) for details on:
- Code style and standards
- Development process
- Testing requirements
- Pull request procedures

## üìä Project Status

- ‚úÖ Phase 1-4: Analysis, Planning, Architecture, Documentation **COMPLETE**
- ‚úÖ Database migration plan and scripts **READY**
- ‚úÖ Security architecture and implementation **DESIGNED**
- üîÑ Phase 5: Backend development **IN PROGRESS**
- üîÑ Phase 6: Frontend development **NEXT**
- üîÑ Phase 7: Integration and testing **PLANNED**

## üìÑ License

MIT License - See [LICENSE](./LICENSE) file for details

## üë• Team

- **Project Lead:** [Your Name]
- **Backend Lead:** [Your Name]
- **Frontend Lead:** [Your Name]

## üìû Support

For issues, questions, or discussions:
- GitHub Issues: [repository-url]/issues
- Documentation: See [REFERENCE.md](./REFERENCE.md)
- Email: support@kharisma-abadi.local

---

**Status:** Ready for development phase

**Last Updated:** October 2025

**Next Steps:** Review `REFERENCE.md` and begin Phase 5 development
